{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python2.7/dist-packages/sklearn/cross_validation.py:44: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.\n",
      "  \"This module will be removed in 0.20.\", DeprecationWarning)\n",
      "/usr/local/lib/python2.7/dist-packages/sklearn/grid_search.py:43: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. This module will be removed in 0.20.\n",
      "  DeprecationWarning)\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import re\n",
    "import json, codecs\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from dateutil.parser import parse\n",
    "from datetime import datetime, date, time, timedelta\n",
    "import xgboost as xgb\n",
    "from xgboost.sklearn import XGBClassifier\n",
    "from sklearn.preprocessing import scale\n",
    "from sklearn import (manifold, decomposition, ensemble, discriminant_analysis, random_projection)\n",
    "from sklearn import cross_validation, metrics\n",
    "from sklearn.grid_search import GridSearchCV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "def print_full(x):\n",
    "    pd.set_option('display.max_rows', len(x))\n",
    "    print(x)\n",
    "    pd.reset_option('display.max_rows')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(195343, 251)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "os.chdir('/project/')\n",
    "sam = pd.read_csv('./Data/cli_cma_joined_1pct.csv', dtype=object)\n",
    "# sam_cma = pd.read_csv('./Data/cli_cma_1pct.csv', dtype=object)\n",
    "# sam_all = pd.merge(sam, sam_cma, on=['CREDITCYCLEFACTMKEY'])\n",
    "sam.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index([u'SNAPDATE', u'DWACCTID', u'CUSTOMERNUMBER', u'CYCLEDATE',\n",
       "       u'HADINCREASE', u'FIRSTMEASURABLEDATE', u'MAXREVIEWDATE',\n",
       "       u'INCREASEDATE', u'INCRTYPE', u'RANDOMNUM',\n",
       "       ...\n",
       "       u'CMA3926', u'CMA3932', u'CMA3151', u'CMA3635', u'CMA3170', u'CMA3209',\n",
       "       u'CMA3660', u'CMA3652', u'CMA3662', u'CMA3682'],\n",
       "      dtype='object', length=251)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sam.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                                           count  unique                  top  \\\n",
      "SNAPDATE                                  195343       1             20140905   \n",
      "DWACCTID                                  195343    5119              4884754   \n",
      "CUSTOMERNUMBER                            195343    5119           2360015969   \n",
      "CYCLEDATE                                 195343     686           2014-08-15   \n",
      "HADINCREASE                               195343       2                    0   \n",
      "FIRSTMEASURABLEDATE                       195343      97           2014-09-09   \n",
      "MAXREVIEWDATE                             192286      55  2014-09-03 00:00:00   \n",
      "INCREASEDATE                               28503      83  2014-03-05 00:00:00   \n",
      "INCRTYPE                                   28503       2            Temporary   \n",
      "RANDOMNUM                                 195343    5119    0.000420096796202   \n",
      "FIRSTSTATEMENTDATE                        195343    1111  1900-01-01 00:00:00   \n",
      "FIRSTBSBCREDITORDERDATE                   195343    2046  1900-01-01 00:00:00   \n",
      "ACCOUNTOPENDATE                           195343    2375  2013-11-15 00:00:00   \n",
      "ACCOUNTCLOSEDATE                          195343     297  1900-01-01 00:00:00   \n",
      "CREDITCYCLEFACTMKEY                       195343  195343            538413963   \n",
      "SCORE01                                   195343     252                   -1   \n",
      "SCORE02                                   195343     279                   -1   \n",
      "SCORE03                                   195343     274                   -1   \n",
      "SCORE04                                   195343     441                    0   \n",
      "SCORE05                                   195343     741                   -1   \n",
      "SCORE06                                   195343      60                   -1   \n",
      "SCORE07                                   195343     161                    0   \n",
      "SCORE08                                   195343     288                   -1   \n",
      "SCORE09                                   195343     276                   -1   \n",
      "STATEMENTMINIMUMPAYMENTDUE                195343   11781                  0.0   \n",
      "BRAND                                     195343       1            Fingerhut   \n",
      "ADDRESSBADIND                             195343       3                   -1   \n",
      "CURRENTBAL                                195343   97387                  0.0   \n",
      "ACCUMDEFERREDINTEREST                     195343     208                  0.0   \n",
      "CHARGEOFFDATE                             195343     214  1900-01-01 00:00:00   \n",
      "CLIINELIGIBLEDATE                         195343     114  1900-01-01 00:00:00   \n",
      "CLIINELIGIBLEIND                          195343       2                    0   \n",
      "COLLECTIONCODE                            195343       9                    0   \n",
      "CREDITLIMITAMOUNT                         195343     661               1500.0   \n",
      "CREDITLIMITCHANGEREASON                   182558      10                    H   \n",
      "CURRENTDAYSPASTDUE                        195343       6                    0   \n",
      "CURRENTDAYSPASTDUEDELINQUENT              195343      86                    0   \n",
      "CUSTOMERAPR                               195343       6                 24.9   \n",
      "CUSTOMERSEGMENT                           195343      33                   F    \n",
      "CYCLEDUE                                  195343       8                  0.0   \n",
      "DAYSDELQ                                  195343      81                    0   \n",
      "DAYSSINCELASTSALE                         195343    2151                   -1   \n",
      "DECEASEDCODE                              195343       2                   N    \n",
      "DTIFLAG                                   112618       2                   Un   \n",
      "EMAILBADIND                               195343       3                    0   \n",
      "EXTERNALSTATUSCODE                        195343       6                        \n",
      "EXTERNALSTATUSREASONCODE                  195343      31                    0   \n",
      "FINANCECHARGEBAL                          195343   16020                  0.0   \n",
      "HOMEPHONEBADIND                           195343       3                    0   \n",
      "INTERNALSTATUSCODE                        195343       5                        \n",
      "LASTCOLLECTIONSCASEOPENDATE               195343    2028  1900-01-01 00:00:00   \n",
      "LASTPAYMENTDATE                           195343    1772  1900-01-01 00:00:00   \n",
      "LEGACYDAYSDELINQUENT                      195343       1                    0   \n",
      "LTDMAXDAYSDELQ                            195343     235                    0   \n",
      "LTDNETPAYMENTTALLY                        195343     188                    0   \n",
      "MANUALSTATUSCODE                          195343       8                   -1   \n",
      "MARGINRATE                                195343       3                  0.0   \n",
      "MOSTRECENTRECORDIND                       195343       1                    0   \n",
      "NONDEFERREDBAL                            195343   91968                  0.0   \n",
      "NOPAYDEFERREDBAL                          195343   25237                  0.0   \n",
      "NSFCODE                                   195343       5                        \n",
      "NUMBEROFMTHSINACTIVE                      195343      21                    0   \n",
      "OTHERFEEBAL                               195343     182                  0.0   \n",
      "OVERLIMITAMOUNT                           195343    6100                  0.0   \n",
      "PAYMENTDUEDATE                            195343     672  1900-01-01 00:00:00   \n",
      "PLACEDORDERFLAG                           195343       2                    1   \n",
      "CTCDPAYMENTAMOUNT                         195343   11424                  0.0   \n",
      "CTCDPAYMENTRVSLAMOUNT                     195343      42                  0.0   \n",
      "CTCDPAYMENTTALLY                          195343      13                    1   \n",
      "CTCDCHARGEOFFSAMOUNT                      195343       1                  0.0   \n",
      "CTCDBSBPURCHAMOUNT                        195343   10009                  0.0   \n",
      "CTCDBSBPURCHRVSLAMOUNT                    195343      73                  0.0   \n",
      "CTCDBSBPURCHRVSLTALLY                     195343       7                    0   \n",
      "CTCDBSBPURCHTALLY                         195343      18                    0   \n",
      "CTCDNSFFEEAMOUNT                          195343      20                  0.0   \n",
      "CTCDLATECHARGEAMOUNT                      195343     141                  0.0   \n",
      "CTCDLATECHARGERVSLAMOUNT                  195343      58                  0.0   \n",
      "LTCDPAYMENTAMOUNT                         195343   94730                  0.0   \n",
      "LTCDPAYMENTRVSLAMOUNT                     195343      55                  0.0   \n",
      "LTCDPAYMENTTALLY                          195343     188                    0   \n",
      "LTCDCHARGEOFFSAMOUNT                      195343       1                  0.0   \n",
      "LTCDBSBPURCHAMOUNT                        195343   26988                  0.0   \n",
      "LTCDBSBPURCHRVSLAMOUNT                    195343     133                  0.0   \n",
      "LTCDBSBPURCHRVSLTALLY                     195343       7                    0   \n",
      "LTCDBSBPURCHTALLY                         195343     124                    1   \n",
      "FHACCOUNTNUMBER                           192286    5119           0019958027   \n",
      "REVIEWDATE                                192286      55  2014-09-03 00:00:00   \n",
      "SCORE                                     192201     403               -999.0   \n",
      "FRAUDALERTFLAG                              2054       4                    X   \n",
      "ADDRESSDISCREPANCYFLAG                    191640       2                    N   \n",
      "FRAUDALERTCODE                             96365       3                    N   \n",
      "CRITERIACODEANDDNSCODE                    192286       3                    A   \n",
      "RISKREASON1                                47037      26                 38.0   \n",
      "RISKREASON2                                47037      29                 34.0   \n",
      "RISKREASON3                                47037      30                 10.0   \n",
      "RISKREASON4                                47037      30                 10.0   \n",
      "OPENITYPETRADEBALTOTAL                     47270   21012                500.0   \n",
      "MO12BANKINSTALLCOUNT                      191640      12                  0.0   \n",
      "OPENBANKRTYPEHIGHCREDITTOTAL              152572    5631                500.0   \n",
      "GOODRTYPETRADECOUNT                       191640      35                  0.0   \n",
      "MO12REVOPENBANKCARDCOUNT                  191640      12                  0.0   \n",
      "R6039_OPENBANKREVTRADECOUNT               190974      33                  1.0   \n",
      "R6051_MOSINCEDLAFORBANKREVTRADE           190974     122                  0.0   \n",
      "R6054_REVTRADEPASTDUECOUNT                190974      25                 93.0   \n",
      "R6057_REVTRADEPASTDUEAMOUNT                   27       4            9999993.0   \n",
      "R6060_REVTRADEWORSTCURRENTRATING              27       2                  1.0   \n",
      "R6063_REVTRADESATISFACTORYCOUNT           190974      39                  2.0   \n",
      "R6066_D30REVTRADECOUNT                    190974      14                  0.0   \n",
      "R6075_REVTRADEBADDEBTCOUNT                    27       4                  0.0   \n",
      "R6093_MO24REVTRADENEVER30DCOUNT           190974      38                  1.0   \n",
      "R6096_MO24REVTRADE30DNEVER60DCOUNT            27       3                  0.0   \n",
      "R6099_MO24REVTRADE60DNEVER90DCOUNT            27       3                  0.0   \n",
      "R6102_MO24REVTRADE90DNEVERBADCOUNT            27       3                  0.0   \n",
      "R6105_MO24REVTRADEBADCOUNT                    27       4                  0.0   \n",
      "R6114_REVTRADE75PERHIGHCOUNT              190974      24                  1.0   \n",
      "R6117_REVTRADE50PERHIGHCOUNT              190974      25                  1.0   \n",
      "MO12OPENRETAILCOUNT                       191640      18                  0.0   \n",
      "MO03PROMOTIONINQUIRYCOUNT                 191640      26                  0.0   \n",
      "R6040_OPENDEPTTRADECOUNT                  190974      19                 97.0   \n",
      "R6073_D90DEPTTRADECOUNT                   190974       9                  0.0   \n",
      "R6076_DEPTTRADEBADDEBTCOUNT               190974      11                  0.0   \n",
      "R6115_DEPTTRADEBAL75HIGHCREDITCOUNT       190974      11                 97.0   \n",
      "NONFHBALTOTAL                             189369   71083                  0.0   \n",
      "NONFHOPENTRADECOUNT                       191640      35                  1.0   \n",
      "R6195_AGE                                 190974      76                 55.0   \n",
      "R6196_BALHIGHCREDITPERCENT                190974   12864                  0.0   \n",
      "R6197_BANKBALHIGHCREDITPERCENT            190974   12415                  0.0   \n",
      "R6198_DEPTBALHIGHCREDITDEPTPERCENT        190974   10709              99997.0   \n",
      "R6199_CONSUMERBALHIGHCREDITPERCENT        190974    9166              99997.0   \n",
      "R6200_SATISFACTORYTRADEPERCENT            190974    1270              10000.0   \n",
      "OPENMORTGAGETRADECOUNT                    191640       4                  0.0   \n",
      "R6205_MO24TRADE90DCOUNT                   190974      36                  0.0   \n",
      "R6206_MO24BANKTRADE90DCOUNT               190974      25                  0.0   \n",
      "R6207_MO24DEPTTRADE90DCOUNT                   27       4                  2.0   \n",
      "R7006_MO24PUBLICRECNOMEDCOUNT             190974      67                 99.0   \n",
      "R8003_PUBLICRECPLUSBADDEBTNOMEDCOUNT      190974      69                  0.0   \n",
      "R8004_MO24BADDEBTPLUSPUBLICRECDEROGCOUNT  190974      71                  0.0   \n",
      "R6246_TRADE30DORWORSECOUNT                190974      40                  0.0   \n",
      "R6250_MO24TRADE30DORWORSECOUNT            190974      38                  0.0   \n",
      "R6251_MO24BANKTRADE30DORWORSECOUNT        190974      25                  0.0   \n",
      "R6252_MO24DEPTTRADE30DORWORSECOUNT            27       4                  2.0   \n",
      "R6254_MO24TRADE60DORWORSECOUNT            190974      35                  0.0   \n",
      "R6255_MO24BANKTRADE60DORWORSECOUNT        190974      24                  0.0   \n",
      "R6256_MO24DEPTTRADE60DORWORSECOUNT            27       4                  2.0   \n",
      "R5006_MO06PROMOTIONINQUIRYCOUNT           190974      71                 97.0   \n",
      "R5007_MO06BANKPROMOTIONINQUIRYCOUNT       190974      41                 97.0   \n",
      "R6258_SATISFACTORYTRADEWITHBALCOUNT       190974      44                  4.0   \n",
      "R6259_SATISFACTORYBANKTRADEWITHBALCOUNT   190974      28                  1.0   \n",
      "R6260_SATISFACTORYDEPTTRADEWITHBALCOUNT   190974      13                 97.0   \n",
      "R7000_DEROGATORYPUBLICRECORDCOUNT         190974      76                 99.0   \n",
      "R7001_MOSINCELASTPUBLICRECORDCOUNT        190974     169               9999.0   \n",
      "R8000_COLLECTIONCOUNT                     190974      73                  0.0   \n",
      "R5000_MO06INQUIRYCOUNT                    190974      50                  0.0   \n",
      "R5001_MOSINCELASTINQUIRYCOUNT             190974      26                  1.0   \n",
      "R5003_MO06PROMOTIONINQUIRYCOUNT2          190974      95                  9.0   \n",
      "R6003_OLDESTTRADEAGE                      190974     661                146.0   \n",
      "R6004_NEWESTTRADEAGE                      190974     176                  2.0   \n",
      "R6005_MO03TRADEOPENEDCOUNT                190974      20                  0.0   \n",
      "R6006_MO06TRADEOPENCOUNT                  190974      24                  0.0   \n",
      "R6007_MO12TRADEOPENCOUNT                  190974      31                  0.0   \n",
      "R6008_MO24TRADEOPENCOUNT                  190974      50                  1.0   \n",
      "R6009_TRADECOUNT                          190974      93                 11.0   \n",
      "R6010_OPENTRADECOUNT                      190974      59                  6.0   \n",
      "R6011_OPENTRADEBALTOTAL                   190974   51659                  0.0   \n",
      "R6012_OPENTRADEHIGHCREDITTOTAL            190974   46756                200.0   \n",
      "R8002_MOSINCELASTACTIVITYCOUNT            190974      25                  0.0   \n",
      "R6014_CURRENTTRADEPASTDUECOUNT            190974      32                 93.0   \n",
      "R6015_CURRENTPASTDUEAMOUNT                190974   13230            9999993.0   \n",
      "R6016_CURRENTWORSTRATING                      27       2                    6   \n",
      "R6017_SATISFACTORYTRADECOUNT              190974      94                  8.0   \n",
      "R6018_D30TRADECOUNT                       190974      17                  0.0   \n",
      "R6019_D60TRADECOUNT                       190974      19                  0.0   \n",
      "R6020_D90TRADECOUNT                       190974      28                  0.0   \n",
      "R6021_BADDEBTTRADECOUNT                   190974      36                  0.0   \n",
      "R6022_TRADENEVER30DCOUNT                  190974      94                  8.0   \n",
      "R6023_TRADE30DNEVER60DCOUNT               190974      23                  0.0   \n",
      "R6024_TRADE60DNEVER90DCOUNT                   27       4                  1.0   \n",
      "R6025_TRADE90DNEVERBADDEBTCOUNT               27       3                  0.0   \n",
      "R6026_LTDBADDEBTTRADECOUNT                190974      36                  0.0   \n",
      "R6027_MO24TRADENEVER30DCOUNT              190974      72                  4.0   \n",
      "R6028_MO24TRADE30DNEVER60DCOUNT               27       2                  0.0   \n",
      "R6029_MO24TRADE60DNEVER90COUNT                27       3                  0.0   \n",
      "R6030_MO24TRADE90DNEVERBADDEBTCOUNT           27       3                  0.0   \n",
      "R6031_MO24TRADEBADDEBTCOUNT               190974      34                  0.0   \n",
      "R6032_OPENTRADEWITHBALCOUNT               190974      49                  5.0   \n",
      "R6034_OPENTRADEBAL75PERHIGHCOUNT          190974      44                  1.0   \n",
      "R6035_OPENTRADEBAL50PERHIGHCOUNT          190974      45                  3.0   \n",
      "BANKRUPCYFLAG                             191640       2                    N   \n",
      "ALLTRADEPAYMENTTOTAL                      191257    6569                  0.0   \n",
      "MO12TRADE30DLATECOUNT                     191640      28                  0.0   \n",
      "MO12TRADE60DLATECOUNT                     191640      31                  0.0   \n",
      "MOSINCELASTDELINQUENCYCOUNT               144914      84                  1.0   \n",
      "LASTBANKRUPTCYDATE                         36819     139             102005.0   \n",
      "MOSINCEMAJORDEROG                         155041     144                  1.0   \n",
      "MO03TRADECLOSEDCOUNT                      191640     108                  0.0   \n",
      "DONOTSOLICITFLAG                           84795       3                    N   \n",
      "B5SCORE                                        0       0                  NaN   \n",
      "B5RISKREASON1                                  0       0                  NaN   \n",
      "B5RISKREASON2                                  0       0                  NaN   \n",
      "B5RISKREASON3                                  0       0                  NaN   \n",
      "B5RISKREASON4                                  0       0                  NaN   \n",
      "R6042_TOTALOPENBALANCE                    190974   18170                  0.0   \n",
      "RMS5002                                   189802      35                 97.0   \n",
      "RMS6045                                   190974    5374            9999997.0   \n",
      "RMS6072                                   190974      16                  0.0   \n",
      "RMS6041                                   190974      15                 97.0   \n",
      "RMS6044                                   190974    6426            9999997.0   \n",
      "MODELNAME                                 192286       1                 BC96   \n",
      "SCOREINDICATOR                            192286       2                   No   \n",
      "VANTAGESCORE                                   0       0                  NaN   \n",
      "VANTAGEREASON1                                 0       0                  NaN   \n",
      "VANTAGEREASON2                                 0       0                  NaN   \n",
      "VANTAGEREASON3                                 0       0                  NaN   \n",
      "VANTAGEREASON4                                 0       0                  NaN   \n",
      "OFACFLAG                                       0       0                  NaN   \n",
      "BRANDXID                                  192286       2                  1.0   \n",
      "CMA3000                                   190947      35                  0.0   \n",
      "CMA3001                                   190947      66                  1.0   \n",
      "CMA3109                                   190947      65                  6.0   \n",
      "CMA3120                                   190947     663                 86.0   \n",
      "CMA3139                                   190947      31                  1.0   \n",
      "CMA3146                                   190947      55                  2.0   \n",
      "CMA3159                                   190947   50754                  0.0   \n",
      "CMA3161                                   190947   15555            9999998.0   \n",
      "CMA3164                                   190947   57126            9999998.0   \n",
      "CMA3165                                   190947   23796            9999998.0   \n",
      "CMA3168                                   190947   22947                  0.0   \n",
      "CMA3204                                   190947    2733            9999998.0   \n",
      "CMA3208                                   190947   12597               1500.0   \n",
      "CMA3235                                   190947    4864                  0.0   \n",
      "CMA3236                                   190947    8667                  0.0   \n",
      "CMA3907                                   190947      44                  0.0   \n",
      "CMA3909                                   190947      75                  0.0   \n",
      "CMA3911                                   190947    3281            9999998.0   \n",
      "CMA3913                                   190947    7017            9999998.0   \n",
      "CMA3842                                   190947     354              10000.0   \n",
      "CMA3845                                   190947     275                  0.0   \n",
      "CMA3854                                   190947   12265              99998.0   \n",
      "CMA3856                                   190947   11818                  0.0   \n",
      "CMA3917                                   190947      30                  0.0   \n",
      "CMA3920                                   190947      22                  0.0   \n",
      "CMA3926                                   190947      23                  0.0   \n",
      "CMA3932                                   190947      29                  0.0   \n",
      "CMA3151                                   190974       8                   98   \n",
      "CMA3635                                   190974      10                   98   \n",
      "CMA3170                                   190974   23205              9999998   \n",
      "CMA3209                                   190974    1527              9999998   \n",
      "CMA3660                                   190974      19                   00   \n",
      "CMA3652                                   190974       5                   98   \n",
      "CMA3662                                   190974      21                   00   \n",
      "CMA3682                                   190974       6                   98   \n",
      "\n",
      "                                            freq  \n",
      "SNAPDATE                                  195343  \n",
      "DWACCTID                                      44  \n",
      "CUSTOMERNUMBER                                44  \n",
      "CYCLEDATE                                    407  \n",
      "HADINCREASE                               128479  \n",
      "FIRSTMEASURABLEDATE                        13783  \n",
      "MAXREVIEWDATE                              12008  \n",
      "INCREASEDATE                                1790  \n",
      "INCRTYPE                                   20214  \n",
      "RANDOMNUM                                     44  \n",
      "FIRSTSTATEMENTDATE                          3011  \n",
      "FIRSTBSBCREDITORDERDATE                     2876  \n",
      "ACCOUNTOPENDATE                              460  \n",
      "ACCOUNTCLOSEDATE                          189199  \n",
      "CREDITCYCLEFACTMKEY                            1  \n",
      "SCORE01                                    71575  \n",
      "SCORE02                                    71575  \n",
      "SCORE03                                    71575  \n",
      "SCORE04                                    78704  \n",
      "SCORE05                                    71575  \n",
      "SCORE06                                    71575  \n",
      "SCORE07                                   119556  \n",
      "SCORE08                                    71575  \n",
      "SCORE09                                    71575  \n",
      "STATEMENTMINIMUMPAYMENTDUE                 46121  \n",
      "BRAND                                     195343  \n",
      "ADDRESSBADIND                             184895  \n",
      "CURRENTBAL                                 36498  \n",
      "ACCUMDEFERREDINTEREST                     195093  \n",
      "CHARGEOFFDATE                             190778  \n",
      "CLIINELIGIBLEDATE                         186205  \n",
      "CLIINELIGIBLEIND                          195283  \n",
      "COLLECTIONCODE                            192103  \n",
      "CREDITLIMITAMOUNT                           7710  \n",
      "CREDITLIMITCHANGEREASON                    65930  \n",
      "CURRENTDAYSPASTDUE                        192023  \n",
      "CURRENTDAYSPASTDUEDELINQUENT              175300  \n",
      "CUSTOMERAPR                               179856  \n",
      "CUSTOMERSEGMENT                            73134  \n",
      "CYCLEDUE                                  124269  \n",
      "DAYSDELQ                                  178620  \n",
      "DAYSSINCELASTSALE                           3784  \n",
      "DECEASEDCODE                              194747  \n",
      "DTIFLAG                                   105966  \n",
      "EMAILBADIND                               180596  \n",
      "EXTERNALSTATUSCODE                        188253  \n",
      "EXTERNALSTATUSREASONCODE                  189452  \n",
      "FINANCECHARGEBAL                           49952  \n",
      "HOMEPHONEBADIND                           180308  \n",
      "INTERNALSTATUSCODE                        174773  \n",
      "LASTCOLLECTIONSCASEOPENDATE                61040  \n",
      "LASTPAYMENTDATE                             5203  \n",
      "LEGACYDAYSDELINQUENT                      195343  \n",
      "LTDMAXDAYSDELQ                             79296  \n",
      "LTDNETPAYMENTTALLY                          5252  \n",
      "MANUALSTATUSCODE                          123768  \n",
      "MARGINRATE                                158678  \n",
      "MOSTRECENTRECORDIND                       195343  \n",
      "NONDEFERREDBAL                             41985  \n",
      "NOPAYDEFERREDBAL                          162267  \n",
      "NSFCODE                                   193598  \n",
      "NUMBEROFMTHSINACTIVE                      176538  \n",
      "OTHERFEEBAL                               191623  \n",
      "OVERLIMITAMOUNT                           184579  \n",
      "PAYMENTDUEDATE                             42427  \n",
      "PLACEDORDERFLAG                           192510  \n",
      "CTCDPAYMENTAMOUNT                          58384  \n",
      "CTCDPAYMENTRVSLAMOUNT                     195270  \n",
      "CTCDPAYMENTTALLY                          128622  \n",
      "CTCDCHARGEOFFSAMOUNT                      195343  \n",
      "CTCDBSBPURCHAMOUNT                        167432  \n",
      "CTCDBSBPURCHRVSLAMOUNT                    195247  \n",
      "CTCDBSBPURCHRVSLTALLY                     195247  \n",
      "CTCDBSBPURCHTALLY                         167432  \n",
      "CTCDNSFFEEAMOUNT                          195136  \n",
      "CTCDLATECHARGEAMOUNT                      170803  \n",
      "CTCDLATECHARGERVSLAMOUNT                  191111  \n",
      "LTCDPAYMENTAMOUNT                           5282  \n",
      "LTCDPAYMENTRVSLAMOUNT                     191931  \n",
      "LTCDPAYMENTTALLY                            5282  \n",
      "LTCDCHARGEOFFSAMOUNT                      195343  \n",
      "LTCDBSBPURCHAMOUNT                          2906  \n",
      "LTCDBSBPURCHRVSLAMOUNT                    189353  \n",
      "LTCDBSBPURCHRVSLTALLY                     189353  \n",
      "LTCDBSBPURCHTALLY                          16874  \n",
      "FHACCOUNTNUMBER                               44  \n",
      "REVIEWDATE                                 12008  \n",
      "SCORE                                     154046  \n",
      "FRAUDALERTFLAG                               851  \n",
      "ADDRESSDISCREPANCYFLAG                    189349  \n",
      "FRAUDALERTCODE                             95625  \n",
      "CRITERIACODEANDDNSCODE                    190798  \n",
      "RISKREASON1                                22032  \n",
      "RISKREASON2                                13099  \n",
      "RISKREASON3                                10431  \n",
      "RISKREASON4                                10055  \n",
      "OPENITYPETRADEBALTOTAL                        64  \n",
      "MO12BANKINSTALLCOUNT                      167965  \n",
      "OPENBANKRTYPEHIGHCREDITTOTAL                6301  \n",
      "GOODRTYPETRADECOUNT                        33207  \n",
      "MO12REVOPENBANKCARDCOUNT                  129870  \n",
      "R6039_OPENBANKREVTRADECOUNT                37233  \n",
      "R6051_MOSINCEDLAFORBANKREVTRADE            84638  \n",
      "R6054_REVTRADEPASTDUECOUNT                132061  \n",
      "R6057_REVTRADEPASTDUEAMOUNT                   22  \n",
      "R6060_REVTRADEWORSTCURRENTRATING              22  \n",
      "R6063_REVTRADESATISFACTORYCOUNT            27545  \n",
      "R6066_D30REVTRADECOUNT                    160458  \n",
      "R6075_REVTRADEBADDEBTCOUNT                    22  \n",
      "R6093_MO24REVTRADENEVER30DCOUNT            37051  \n",
      "R6096_MO24REVTRADE30DNEVER60DCOUNT            23  \n",
      "R6099_MO24REVTRADE60DNEVER90DCOUNT            23  \n",
      "R6102_MO24REVTRADE90DNEVERBADCOUNT            23  \n",
      "R6105_MO24REVTRADEBADCOUNT                    22  \n",
      "R6114_REVTRADE75PERHIGHCOUNT               43900  \n",
      "R6117_REVTRADE50PERHIGHCOUNT               43751  \n",
      "MO12OPENRETAILCOUNT                       152329  \n",
      "MO03PROMOTIONINQUIRYCOUNT                 106318  \n",
      "R6040_OPENDEPTTRADECOUNT                   80671  \n",
      "R6073_D90DEPTTRADECOUNT                   104109  \n",
      "R6076_DEPTTRADEBADDEBTCOUNT                89582  \n",
      "R6115_DEPTTRADEBAL75HIGHCREDITCOUNT        80671  \n",
      "NONFHBALTOTAL                               4399  \n",
      "NONFHOPENTRADECOUNT                        27032  \n",
      "R6195_AGE                                   5498  \n",
      "R6196_BALHIGHCREDITPERCENT                  1984  \n",
      "R6197_BANKBALHIGHCREDITPERCENT             18452  \n",
      "R6198_DEPTBALHIGHCREDITDEPTPERCENT         80671  \n",
      "R6199_CONSUMERBALHIGHCREDITPERCENT        116500  \n",
      "R6200_SATISFACTORYTRADEPERCENT             10121  \n",
      "OPENMORTGAGETRADECOUNT                    151978  \n",
      "R6205_MO24TRADE90DCOUNT                    88940  \n",
      "R6206_MO24BANKTRADE90DCOUNT               131291  \n",
      "R6207_MO24DEPTTRADE90DCOUNT                   17  \n",
      "R7006_MO24PUBLICRECNOMEDCOUNT              67013  \n",
      "R8003_PUBLICRECPLUSBADDEBTNOMEDCOUNT       63865  \n",
      "R8004_MO24BADDEBTPLUSPUBLICRECDEROGCOUNT   58785  \n",
      "R6246_TRADE30DORWORSECOUNT                 41295  \n",
      "R6250_MO24TRADE30DORWORSECOUNT             68678  \n",
      "R6251_MO24BANKTRADE30DORWORSECOUNT        116011  \n",
      "R6252_MO24DEPTTRADE30DORWORSECOUNT            18  \n",
      "R6254_MO24TRADE60DORWORSECOUNT             83400  \n",
      "R6255_MO24BANKTRADE60DORWORSECOUNT        126688  \n",
      "R6256_MO24DEPTTRADE60DORWORSECOUNT            18  \n",
      "R5006_MO06PROMOTIONINQUIRYCOUNT            15183  \n",
      "R5007_MO06BANKPROMOTIONINQUIRYCOUNT        67978  \n",
      "R6258_SATISFACTORYTRADEWITHBALCOUNT        20726  \n",
      "R6259_SATISFACTORYBANKTRADEWITHBALCOUNT    39898  \n",
      "R6260_SATISFACTORYDEPTTRADEWITHBALCOUNT    80671  \n",
      "R7000_DEROGATORYPUBLICRECORDCOUNT          67013  \n",
      "R7001_MOSINCELASTPUBLICRECORDCOUNT         67013  \n",
      "R8000_COLLECTIONCOUNT                      93908  \n",
      "R5000_MO06INQUIRYCOUNT                     58964  \n",
      "R5001_MOSINCELASTINQUIRYCOUNT              26382  \n",
      "R5003_MO06PROMOTIONINQUIRYCOUNT2            7061  \n",
      "R6003_OLDESTTRADEAGE                        1140  \n",
      "R6004_NEWESTTRADEAGE                       21853  \n",
      "R6005_MO03TRADEOPENEDCOUNT                128815  \n",
      "R6006_MO06TRADEOPENCOUNT                   89826  \n",
      "R6007_MO12TRADEOPENCOUNT                   50140  \n",
      "R6008_MO24TRADEOPENCOUNT                   29027  \n",
      "R6009_TRADECOUNT                            7629  \n",
      "R6010_OPENTRADECOUNT                       16835  \n",
      "R6011_OPENTRADEBALTOTAL                     1985  \n",
      "R6012_OPENTRADEHIGHCREDITTOTAL               525  \n",
      "R8002_MOSINCELASTACTIVITYCOUNT            148518  \n",
      "R6014_CURRENTTRADEPASTDUECOUNT            106037  \n",
      "R6015_CURRENTPASTDUEAMOUNT                106037  \n",
      "R6016_CURRENTWORSTRATING                      25  \n",
      "R6017_SATISFACTORYTRADECOUNT                9226  \n",
      "R6018_D30TRADECOUNT                       167365  \n",
      "R6019_D60TRADECOUNT                       179994  \n",
      "R6020_D90TRADECOUNT                       164461  \n",
      "R6021_BADDEBTTRADECOUNT                    81225  \n",
      "R6022_TRADENEVER30DCOUNT                    9618  \n",
      "R6023_TRADE30DNEVER60DCOUNT               109427  \n",
      "R6024_TRADE60DNEVER90DCOUNT                   17  \n",
      "R6025_TRADE90DNEVERBADDEBTCOUNT               21  \n",
      "R6026_LTDBADDEBTTRADECOUNT                 80806  \n",
      "R6027_MO24TRADENEVER30DCOUNT               14233  \n",
      "R6028_MO24TRADE30DNEVER60DCOUNT               23  \n",
      "R6029_MO24TRADE60DNEVER90COUNT                24  \n",
      "R6030_MO24TRADE90DNEVERBADDEBTCOUNT           22  \n",
      "R6031_MO24TRADEBADDEBTCOUNT                98570  \n",
      "R6032_OPENTRADEWITHBALCOUNT                19663  \n",
      "R6034_OPENTRADEBAL75PERHIGHCOUNT           28719  \n",
      "R6035_OPENTRADEBAL50PERHIGHCOUNT           22774  \n",
      "BANKRUPCYFLAG                             154821  \n",
      "ALLTRADEPAYMENTTOTAL                        1349  \n",
      "MO12TRADE30DLATECOUNT                     140047  \n",
      "MO12TRADE60DLATECOUNT                     105470  \n",
      "MOSINCELASTDELINQUENCYCOUNT                41644  \n",
      "LASTBANKRUPTCYDATE                          2209  \n",
      "MOSINCEMAJORDEROG                          43915  \n",
      "MO03TRADECLOSEDCOUNT                       23739  \n",
      "DONOTSOLICITFLAG                           68232  \n",
      "B5SCORE                                      NaN  \n",
      "B5RISKREASON1                                NaN  \n",
      "B5RISKREASON2                                NaN  \n",
      "B5RISKREASON3                                NaN  \n",
      "B5RISKREASON4                                NaN  \n",
      "R6042_TOTALOPENBALANCE                     18452  \n",
      "RMS5002                                    76621  \n",
      "RMS6045                                    17993  \n",
      "RMS6072                                   158308  \n",
      "RMS6041                                   116500  \n",
      "RMS6044                                   116500  \n",
      "MODELNAME                                 192286  \n",
      "SCOREINDICATOR                            154044  \n",
      "VANTAGESCORE                                 NaN  \n",
      "VANTAGEREASON1                               NaN  \n",
      "VANTAGEREASON2                               NaN  \n",
      "VANTAGEREASON3                               NaN  \n",
      "VANTAGEREASON4                               NaN  \n",
      "OFACFLAG                                     NaN  \n",
      "BRANDXID                                  187187  \n",
      "CMA3000                                    91472  \n",
      "CMA3001                                    39833  \n",
      "CMA3109                                    13829  \n",
      "CMA3120                                     1017  \n",
      "CMA3139                                    41482  \n",
      "CMA3146                                    23289  \n",
      "CMA3159                                     3397  \n",
      "CMA3161                                    45351  \n",
      "CMA3164                                    66115  \n",
      "CMA3165                                   150461  \n",
      "CMA3168                                     6196  \n",
      "CMA3204                                    45351  \n",
      "CMA3208                                     1894  \n",
      "CMA3235                                   153938  \n",
      "CMA3236                                   136849  \n",
      "CMA3907                                   145547  \n",
      "CMA3909                                    84534  \n",
      "CMA3911                                    81656  \n",
      "CMA3913                                    81656  \n",
      "CMA3842                                    63615  \n",
      "CMA3845                                   118311  \n",
      "CMA3854                                    45351  \n",
      "CMA3856                                     6198  \n",
      "CMA3917                                   138374  \n",
      "CMA3920                                   146182  \n",
      "CMA3926                                   145975  \n",
      "CMA3932                                   154162  \n",
      "CMA3151                                   125252  \n",
      "CMA3635                                   151641  \n",
      "CMA3170                                   151641  \n",
      "CMA3209                                   151641  \n",
      "CMA3660                                   180515  \n",
      "CMA3652                                   185348  \n",
      "CMA3662                                   181443  \n",
      "CMA3682                                   185348  \n"
     ]
    }
   ],
   "source": [
    "sam_sum = sam.describe()\n",
    "print_full(sam_sum.transpose())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# all_col = sam.columns.str.upper()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index([u'B5SCORE', u'B5RISKREASON1', u'B5RISKREASON2', u'B5RISKREASON3',\n",
       "       u'B5RISKREASON4', u'VANTAGESCORE', u'VANTAGEREASON1', u'VANTAGEREASON2',\n",
       "       u'VANTAGEREASON3', u'VANTAGEREASON4', u'OFACFLAG'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# import math\n",
    "# nan_col_ind = [math.isnan(val) if isinstance(val, float) else False for val in sam_sum.ix['top',]]\n",
    "nan_col_ind = (sam_sum.ix['count',] == 0)\n",
    "nan_col = sam.columns[nan_col_ind]\n",
    "nan_col\n",
    "# sam.drop(nan_col, axis=1, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index([u'SNAPDATE', u'BRAND', u'LEGACYDAYSDELINQUENT', u'MOSTRECENTRECORDIND',\n",
       "       u'CTCDCHARGEOFFSAMOUNT', u'LTCDCHARGEOFFSAMOUNT', u'MODELNAME'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "oneval_col_ind = (sam_sum.ix['unique',] == 1)\n",
    "oneval_col = sam.columns[oneval_col_ind]\n",
    "oneval_col"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index([u'SNAPDATE', u'CYCLEDATE', u'FIRSTMEASURABLEDATE', u'MAXREVIEWDATE',\n",
       "       u'INCREASEDATE', u'FIRSTSTATEMENTDATE', u'FIRSTBSBCREDITORDERDATE',\n",
       "       u'ACCOUNTOPENDATE', u'ACCOUNTCLOSEDATE', u'CHARGEOFFDATE',\n",
       "       u'CLIINELIGIBLEDATE', u'LASTCOLLECTIONSCASEOPENDATE',\n",
       "       u'LASTPAYMENTDATE', u'PAYMENTDUEDATE', u'REVIEWDATE',\n",
       "       u'LASTBANKRUPTCYDATE'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# import re\n",
    "# [re.match('.*date.*', col, re.IGNORECASE) for col in all_col]\n",
    "# matches = all_col.str.findall('.*date.*', re.IGNORECASE)\n",
    "# matches.str.get(0).tolist()\n",
    "date_col_ind = sam.columns.str.contains('DATE')\n",
    "date_col = sam.columns[date_col_ind]\n",
    "date_col"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['SNAPDATE',\n",
       " 'FIRSTMEASURABLEDATE',\n",
       " 'MAXREVIEWDATE',\n",
       " 'INCREASEDATE',\n",
       " 'FIRSTSTATEMENTDATE',\n",
       " 'FIRSTBSBCREDITORDERDATE',\n",
       " 'ACCOUNTOPENDATE',\n",
       " 'ACCOUNTCLOSEDATE',\n",
       " 'CHARGEOFFDATE',\n",
       " 'CLIINELIGIBLEDATE',\n",
       " 'LASTCOLLECTIONSCASEOPENDATE',\n",
       " 'LASTPAYMENTDATE',\n",
       " 'PAYMENTDUEDATE',\n",
       " 'REVIEWDATE',\n",
       " 'LASTBANKRUPTCYDATE']"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "date_col2 = date_col.tolist()\n",
    "date_col2.remove('CYCLEDATE')\n",
    "date_col2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(195343, 219)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "to_drop = nan_col.tolist() + oneval_col.tolist() + date_col2\n",
    "sam2 = sam.drop(to_drop, axis=1)\n",
    "sam2.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "sam2['INCRTYPE'] = sam2['INCRTYPE'].fillna('Unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['0', '4', '2', '5', '7', '12'], dtype=object)"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sam2['CURRENTDAYSPASTDUE'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "DWACCTID\n",
      "CUSTOMERNUMBER\n",
      "CYCLEDATE\n",
      "HADINCREASE\n",
      "INCRTYPE\n",
      "RANDOMNUM\n",
      "CREDITCYCLEFACTMKEY\n",
      "SCORE01\n",
      "SCORE02\n",
      "SCORE03\n",
      "SCORE04\n",
      "SCORE05\n",
      "SCORE06\n",
      "SCORE07\n",
      "SCORE08\n",
      "SCORE09\n",
      "STATEMENTMINIMUMPAYMENTDUE\n",
      "ADDRESSBADIND\n",
      "CURRENTBAL\n",
      "ACCUMDEFERREDINTEREST\n",
      "CLIINELIGIBLEIND\n",
      "COLLECTIONCODE\n",
      "CREDITLIMITAMOUNT\n",
      "CREDITLIMITCHANGEREASON\n",
      "CURRENTDAYSPASTDUE\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python2.7/dist-packages/ipykernel/__main__.py:15: FutureWarning: \n",
      "Setting NaNs in `categories` is deprecated and will be removed in a future version of pandas.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CURRENTDAYSPASTDUEDELINQUENT\n",
      "CUSTOMERAPR\n",
      "CUSTOMERSEGMENT\n",
      "CYCLEDUE\n",
      "DAYSDELQ\n",
      "DAYSSINCELASTSALE\n",
      "DECEASEDCODE\n",
      "DTIFLAG\n",
      "EMAILBADIND\n",
      "EXTERNALSTATUSCODE\n",
      "EXTERNALSTATUSREASONCODE\n",
      "FINANCECHARGEBAL\n",
      "HOMEPHONEBADIND\n",
      "INTERNALSTATUSCODE\n",
      "LTDMAXDAYSDELQ\n",
      "LTDNETPAYMENTTALLY\n",
      "MANUALSTATUSCODE\n",
      "MARGINRATE\n",
      "NONDEFERREDBAL\n",
      "NOPAYDEFERREDBAL\n",
      "NSFCODE\n",
      "NUMBEROFMTHSINACTIVE\n",
      "OTHERFEEBAL\n",
      "OVERLIMITAMOUNT\n",
      "PLACEDORDERFLAG\n",
      "CTCDPAYMENTAMOUNT\n",
      "CTCDPAYMENTRVSLAMOUNT\n",
      "CTCDPAYMENTTALLY\n",
      "CTCDBSBPURCHAMOUNT\n",
      "CTCDBSBPURCHRVSLAMOUNT\n",
      "CTCDBSBPURCHRVSLTALLY\n",
      "CTCDBSBPURCHTALLY\n",
      "CTCDNSFFEEAMOUNT\n",
      "CTCDLATECHARGEAMOUNT\n",
      "CTCDLATECHARGERVSLAMOUNT\n",
      "LTCDPAYMENTAMOUNT\n",
      "LTCDPAYMENTRVSLAMOUNT\n",
      "LTCDPAYMENTTALLY\n",
      "LTCDBSBPURCHAMOUNT\n",
      "LTCDBSBPURCHRVSLAMOUNT\n",
      "LTCDBSBPURCHRVSLTALLY\n",
      "LTCDBSBPURCHTALLY\n",
      "FHACCOUNTNUMBER\n",
      "SCORE\n",
      "FRAUDALERTFLAG\n",
      "ADDRESSDISCREPANCYFLAG\n",
      "FRAUDALERTCODE\n",
      "CRITERIACODEANDDNSCODE\n",
      "RISKREASON1\n",
      "RISKREASON2\n",
      "RISKREASON3\n",
      "RISKREASON4\n",
      "OPENITYPETRADEBALTOTAL\n",
      "MO12BANKINSTALLCOUNT\n",
      "OPENBANKRTYPEHIGHCREDITTOTAL\n",
      "GOODRTYPETRADECOUNT\n",
      "MO12REVOPENBANKCARDCOUNT\n",
      "R6039_OPENBANKREVTRADECOUNT\n",
      "R6051_MOSINCEDLAFORBANKREVTRADE\n",
      "R6054_REVTRADEPASTDUECOUNT\n",
      "R6057_REVTRADEPASTDUEAMOUNT\n",
      "R6060_REVTRADEWORSTCURRENTRATING\n",
      "R6063_REVTRADESATISFACTORYCOUNT\n",
      "R6066_D30REVTRADECOUNT\n",
      "R6075_REVTRADEBADDEBTCOUNT\n",
      "R6093_MO24REVTRADENEVER30DCOUNT\n",
      "R6096_MO24REVTRADE30DNEVER60DCOUNT\n",
      "R6099_MO24REVTRADE60DNEVER90DCOUNT\n",
      "R6102_MO24REVTRADE90DNEVERBADCOUNT\n",
      "R6105_MO24REVTRADEBADCOUNT\n",
      "R6114_REVTRADE75PERHIGHCOUNT\n",
      "R6117_REVTRADE50PERHIGHCOUNT\n",
      "MO12OPENRETAILCOUNT\n",
      "MO03PROMOTIONINQUIRYCOUNT\n",
      "R6040_OPENDEPTTRADECOUNT\n",
      "R6073_D90DEPTTRADECOUNT\n",
      "R6076_DEPTTRADEBADDEBTCOUNT\n",
      "R6115_DEPTTRADEBAL75HIGHCREDITCOUNT\n",
      "NONFHBALTOTAL\n",
      "NONFHOPENTRADECOUNT\n",
      "R6195_AGE\n",
      "R6196_BALHIGHCREDITPERCENT\n",
      "R6197_BANKBALHIGHCREDITPERCENT\n",
      "R6198_DEPTBALHIGHCREDITDEPTPERCENT\n",
      "R6199_CONSUMERBALHIGHCREDITPERCENT\n",
      "R6200_SATISFACTORYTRADEPERCENT\n",
      "OPENMORTGAGETRADECOUNT\n",
      "R6205_MO24TRADE90DCOUNT\n",
      "R6206_MO24BANKTRADE90DCOUNT\n",
      "R6207_MO24DEPTTRADE90DCOUNT\n",
      "R7006_MO24PUBLICRECNOMEDCOUNT\n",
      "R8003_PUBLICRECPLUSBADDEBTNOMEDCOUNT\n",
      "R8004_MO24BADDEBTPLUSPUBLICRECDEROGCOUNT\n",
      "R6246_TRADE30DORWORSECOUNT\n",
      "R6250_MO24TRADE30DORWORSECOUNT\n",
      "R6251_MO24BANKTRADE30DORWORSECOUNT\n",
      "R6252_MO24DEPTTRADE30DORWORSECOUNT\n",
      "R6254_MO24TRADE60DORWORSECOUNT\n",
      "R6255_MO24BANKTRADE60DORWORSECOUNT\n",
      "R6256_MO24DEPTTRADE60DORWORSECOUNT\n",
      "R5006_MO06PROMOTIONINQUIRYCOUNT\n",
      "R5007_MO06BANKPROMOTIONINQUIRYCOUNT\n",
      "R6258_SATISFACTORYTRADEWITHBALCOUNT\n",
      "R6259_SATISFACTORYBANKTRADEWITHBALCOUNT\n",
      "R6260_SATISFACTORYDEPTTRADEWITHBALCOUNT\n",
      "R7000_DEROGATORYPUBLICRECORDCOUNT\n",
      "R7001_MOSINCELASTPUBLICRECORDCOUNT\n",
      "R8000_COLLECTIONCOUNT\n",
      "R5000_MO06INQUIRYCOUNT\n",
      "R5001_MOSINCELASTINQUIRYCOUNT\n",
      "R5003_MO06PROMOTIONINQUIRYCOUNT2\n",
      "R6003_OLDESTTRADEAGE\n",
      "R6004_NEWESTTRADEAGE\n",
      "R6005_MO03TRADEOPENEDCOUNT\n",
      "R6006_MO06TRADEOPENCOUNT\n",
      "R6007_MO12TRADEOPENCOUNT\n",
      "R6008_MO24TRADEOPENCOUNT\n",
      "R6009_TRADECOUNT\n",
      "R6010_OPENTRADECOUNT\n",
      "R6011_OPENTRADEBALTOTAL\n",
      "R6012_OPENTRADEHIGHCREDITTOTAL\n",
      "R8002_MOSINCELASTACTIVITYCOUNT\n",
      "R6014_CURRENTTRADEPASTDUECOUNT\n",
      "R6015_CURRENTPASTDUEAMOUNT\n",
      "R6016_CURRENTWORSTRATING\n",
      "R6017_SATISFACTORYTRADECOUNT\n",
      "R6018_D30TRADECOUNT\n",
      "R6019_D60TRADECOUNT\n",
      "R6020_D90TRADECOUNT\n",
      "R6021_BADDEBTTRADECOUNT\n",
      "R6022_TRADENEVER30DCOUNT\n",
      "R6023_TRADE30DNEVER60DCOUNT\n",
      "R6024_TRADE60DNEVER90DCOUNT\n",
      "R6025_TRADE90DNEVERBADDEBTCOUNT\n",
      "R6026_LTDBADDEBTTRADECOUNT\n",
      "R6027_MO24TRADENEVER30DCOUNT\n",
      "R6028_MO24TRADE30DNEVER60DCOUNT\n",
      "R6029_MO24TRADE60DNEVER90COUNT\n",
      "R6030_MO24TRADE90DNEVERBADDEBTCOUNT\n",
      "R6031_MO24TRADEBADDEBTCOUNT\n",
      "R6032_OPENTRADEWITHBALCOUNT\n",
      "R6034_OPENTRADEBAL75PERHIGHCOUNT\n",
      "R6035_OPENTRADEBAL50PERHIGHCOUNT\n",
      "BANKRUPCYFLAG\n",
      "ALLTRADEPAYMENTTOTAL\n",
      "MO12TRADE30DLATECOUNT\n",
      "MO12TRADE60DLATECOUNT\n",
      "MOSINCELASTDELINQUENCYCOUNT\n",
      "MOSINCEMAJORDEROG\n",
      "MO03TRADECLOSEDCOUNT\n",
      "DONOTSOLICITFLAG\n",
      "R6042_TOTALOPENBALANCE\n",
      "RMS5002\n",
      "RMS6045\n",
      "RMS6072\n",
      "RMS6041\n",
      "RMS6044\n",
      "SCOREINDICATOR\n",
      "BRANDXID\n",
      "CMA3000\n",
      "CMA3001\n",
      "CMA3109\n",
      "CMA3120\n",
      "CMA3139\n",
      "CMA3146\n",
      "CMA3159\n",
      "CMA3161\n",
      "CMA3164\n",
      "CMA3165\n",
      "CMA3168\n",
      "CMA3204\n",
      "CMA3208\n",
      "CMA3235\n",
      "CMA3236\n",
      "CMA3907\n",
      "CMA3909\n",
      "CMA3911\n",
      "CMA3913\n",
      "CMA3842\n",
      "CMA3845\n",
      "CMA3854\n",
      "CMA3856\n",
      "CMA3917\n",
      "CMA3920\n",
      "CMA3926\n",
      "CMA3932\n",
      "CMA3151\n",
      "CMA3635\n",
      "CMA3170\n",
      "CMA3209\n",
      "CMA3660\n",
      "CMA3652\n",
      "CMA3662\n",
      "CMA3682\n"
     ]
    }
   ],
   "source": [
    "indata = sam2\n",
    "out_data = pd.DataFrame([])\n",
    "columns_in = sam2.columns.tolist()\n",
    "columns_excl = ['CYCLEDATE', 'CUSTOMERSEGMENT', 'DWACCTID', 'CUSTOMERNUMBER', 'RANDOMNUM', 'CREDITCYCLEFACTMKEY']\n",
    "all_cat = []\n",
    "all_con = []\n",
    "for col_name in columns_in:\n",
    "    print col_name\n",
    "    col_out = indata[col_name]\n",
    "    if col_name not in columns_excl:\n",
    "        if (sam_sum.ix['unique',col_name] > 20):\n",
    "            out_data[col_name] = pd.to_numeric(col_out)\n",
    "            all_con.append(col_name)\n",
    "        if (sam_sum.ix['unique',col_name] <= 20):\n",
    "            out_data[col_name] = pd.Series(pd.Categorical([v for v in col_out],categories=col_out.unique()))\n",
    "            all_cat.append(col_name)\n",
    "    else: out_data[col_name] = col_out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "out_data['CUSTOMERSEGMENT'] = pd.Series(pd.Categorical([v for v in out_data['CUSTOMERSEGMENT']],categories=out_data['CUSTOMERSEGMENT'].unique()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "out = out_data.sort_values(['CUSTOMERNUMBER', 'CYCLEDATE']).groupby(['CUSTOMERNUMBER']).last().reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "con_ft_raw = out_data[all_con + ['CUSTOMERNUMBER']]\n",
    "min_ft = con_ft_raw.groupby('CUSTOMERNUMBER', group_keys=False).apply(lambda x:x.min())\n",
    "max_ft = con_ft_raw.groupby('CUSTOMERNUMBER').apply(lambda x:x.max())\n",
    "con_ft = pd.merge(min_ft, max_ft, on='CUSTOMERNUMBER', suffixes=('_min', '_max'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "last_ft = out.drop(['DWACCTID', 'CYCLEDATE', 'RANDOMNUM', 'CREDITCYCLEFACTMKEY', 'CYCLEDUE'], axis=1)\n",
    "last_ft['CUSTOMERNUMBER'] = last_ft['CUSTOMERNUMBER'].map(float)\n",
    "all_ft = pd.merge(con_ft, last_ft, on='CUSTOMERNUMBER', suffixes=('', '_last'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "target_raw = out_data[['CUSTOMERNUMBER', 'CYCLEDUE']]\n",
    "target = target_raw.groupby('CUSTOMERNUMBER').apply(lambda x:x.max())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "dmat = pd.get_dummies(all_ft, prefix_sep='__')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "dmat.drop(['CUSTOMERNUMBER'], axis=1, inplace=True)\n",
    "target.drop(['CUSTOMERNUMBER'], axis=1, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "xgb_model = xgb.XGBRegressor().fit(dmat, target)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "wt = xgb_model.booster().get_score(importance_type='weight')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                                      Feature  Weight\n",
      "108          CURRENTDAYSPASTDUEDELINQUENT_max     183\n",
      "21                      DAYSSINCELASTSALE_max      37\n",
      "107                               SCORE06_max      33\n",
      "37                         LTDMAXDAYSDELQ_max      27\n",
      "39                                SCORE01_min      19\n",
      "82                   CTCDLATECHARGEAMOUNT_max      17\n",
      "64                         NONDEFERREDBAL_max      16\n",
      "26                            OTHERFEEBAL_max      15\n",
      "34                   NUMBEROFMTHSINACTIVE_max      12\n",
      "51                        OVERLIMITAMOUNT_max      11\n",
      "50                                SCORE07_max      11\n",
      "77                                SCORE02_max      10\n",
      "74                        FHACCOUNTNUMBER_min      10\n",
      "47                                CMA3856_max       9\n",
      "73                          DAYSSINCELASTSALE       9\n",
      "71                     LTDNETPAYMENTTALLY_max       9\n",
      "93                       FINANCECHARGEBAL_max       9\n",
      "13                 STATEMENTMINIMUMPAYMENTDUE       9\n",
      "92                       FINANCECHARGEBAL_min       8\n",
      "62             STATEMENTMINIMUMPAYMENTDUE_max       7\n",
      "40                         LTDMAXDAYSDELQ_min       7\n",
      "132                            NONDEFERREDBAL       6\n",
      "16                      LTCDPAYMENTAMOUNT_max       5\n",
      "67                                    CMA3854       5\n",
      "134                               CMA3913_min       4\n",
      "129                               SCORE09_max       4\n",
      "75                       LTCDPAYMENTTALLY_max       4\n",
      "56                                SCORE04_max       4\n",
      "125                      R6003_OLDESTTRADEAGE       3\n",
      "4                                     SCORE01       3\n",
      "110                            CURRENTBAL_max       3\n",
      "121                               CMA3161_max       3\n",
      "10                      DAYSSINCELASTSALE_min       3\n",
      "9              R6200_SATISFACTORYTRADEPERCENT       3\n",
      "52                                    CMA3845       3\n",
      "66                                CMA3854_max       3\n",
      "109           R6032_OPENTRADEWITHBALCOUNT_min       3\n",
      "86       R5003_MO06PROMOTIONINQUIRYCOUNT2_max       3\n",
      "76           OPENBANKRTYPEHIGHCREDITTOTAL_max       3\n",
      "31                   ALLTRADEPAYMENTTOTAL_min       3\n",
      "80                     LTCDBSBPURCHAMOUNT_min       3\n",
      "91                                CMA3109_max       2\n",
      "103                         CREDITLIMITAMOUNT       2\n",
      "131                                 R6195_AGE       2\n",
      "65        R6093_MO24REVTRADENEVER30DCOUNT_max       2\n",
      "63                                    CMA3662       2\n",
      "83                                    CMA3168       2\n",
      "89             R6246_TRADE30DORWORSECOUNT_min       2\n",
      "81                     LTDNETPAYMENTTALLY_min       2\n",
      "70                                CMA3109_min       2\n",
      "88         R6200_SATISFACTORYTRADEPERCENT_max       2\n",
      "87                        CUSTOMERSEGMENT__F        2\n",
      "100                        CUSTOMERAPR__25.15       2\n",
      "58                             LTDMAXDAYSDELQ       2\n",
      "85           OPENBANKRTYPEHIGHCREDITTOTAL_min       2\n",
      "99                 CREDITLIMITCHANGEREASON__G       2\n",
      "102                           RISKREASON3_max       2\n",
      "0                                 SCORE05_max       2\n",
      "106                         CUSTOMERAPR__14.9       2\n",
      "120           R6023_TRADE30DNEVER60DCOUNT_min       2\n",
      "36             R6196_BALHIGHCREDITPERCENT_max       2\n",
      "25                              R6195_AGE_min       2\n",
      "114        R6200_SATISFACTORYTRADEPERCENT_min       2\n",
      "24                      LTCDPAYMENTAMOUNT_min       2\n",
      "116          R5003_MO06PROMOTIONINQUIRYCOUNT2       2\n",
      "112        R6199_CONSUMERBALHIGHCREDITPERCENT       2\n",
      "111                R6042_TOTALOPENBALANCE_max       2\n",
      "95             R6246_TRADE30DORWORSECOUNT_max       2\n",
      "48        R6063_REVTRADESATISFACTORYCOUNT_min       2\n",
      "49             STATEMENTMINIMUMPAYMENTDUE_min       2\n",
      "53                                  SCORE_max       2\n",
      "54                                    CMA3842       2\n",
      "20                R6011_OPENTRADEBALTOTAL_max       2\n",
      "123                                     SCORE       2\n",
      "33                      CTCDPAYMENTAMOUNT_min       2\n",
      "97                 CREDITLIMITCHANGEREASON__D       1\n",
      "96                   ALLTRADEPAYMENTTOTAL_max       1\n",
      "126              R6008_MO24TRADEOPENCOUNT_min       1\n",
      "122             MO03PROMOTIONINQUIRYCOUNT_max       1\n",
      "135  R6115_DEPTTRADEBAL75HIGHCREDITCOUNT__0.0       1\n",
      "119                     R8000_COLLECTIONCOUNT       1\n",
      "127                R6054_REVTRADEPASTDUECOUNT       1\n",
      "118                     LTCDBSBPURCHTALLY_min       1\n",
      "117                           RISKREASON2_min       1\n",
      "98             R6196_BALHIGHCREDITPERCENT_min       1\n",
      "105               MOSINCELASTDELINQUENCYCOUNT       1\n",
      "115                      ALLTRADEPAYMENTTOTAL       1\n",
      "133              R6007_MO12TRADEOPENCOUNT_min       1\n",
      "128                               CMA3204_max       1\n",
      "113           R6032_OPENTRADEWITHBALCOUNT_max       1\n",
      "101                               CMA3164_min       1\n",
      "124                  R6008_MO24TRADEOPENCOUNT       1\n",
      "104           MOSINCELASTDELINQUENCYCOUNT_min       1\n",
      "130                               CMA3842_min       1\n",
      "68                                    CMA3856       1\n",
      "94                                    CMA3236       1\n",
      "15               R6022_TRADENEVER30DCOUNT_min       1\n",
      "29                                    CMA3235       1\n",
      "28                              NONFHBALTOTAL       1\n",
      "27                     CTCDBSBPURCHAMOUNT_max       1\n",
      "23            R5006_MO06PROMOTIONINQUIRYCOUNT       1\n",
      "22                                CMA3168_max       1\n",
      "19                       CTCDLATECHARGEAMOUNT       1\n",
      "18               CTCDLATECHARGERVSLAMOUNT_min       1\n",
      "17                 R6196_BALHIGHCREDITPERCENT       1\n",
      "14             R6012_OPENTRADEHIGHCREDITTOTAL       1\n",
      "90                     OPENITYPETRADEBALTOTAL       1\n",
      "12                                    RMS5002       1\n",
      "11        R6063_REVTRADESATISFACTORYCOUNT_max       1\n",
      "8                                 CMA3235_min       1\n",
      "7                                     SCORE05       1\n",
      "6                                     SCORE02       1\n",
      "5                                     SCORE03       1\n",
      "3                             RISKREASON4_min       1\n",
      "2                R6027_MO24TRADENEVER30DCOUNT       1\n",
      "30                                 CURRENTBAL       1\n",
      "32                        CUSTOMERSEGMENT__A        1\n",
      "35                                CMA3845_max       1\n",
      "38                       NUMBEROFMTHSINACTIVE       1\n",
      "84                                    CMA3907       1\n",
      "79                                CMA3911_min       1\n",
      "78                                    CMA3161       1\n",
      "72             R6015_CURRENTPASTDUEAMOUNT_min       1\n",
      "69                                CMA3911_max       1\n",
      "1           R7006_MO24PUBLICRECNOMEDCOUNT_max       1\n",
      "61                           NOPAYDEFERREDBAL       1\n",
      "60          R5001_MOSINCELASTINQUIRYCOUNT_max       1\n",
      "59                  MO12TRADE60DLATECOUNT_max       1\n",
      "57       R6034_OPENTRADEBAL75PERHIGHCOUNT_min       1\n",
      "55                            RISKREASON4_max       1\n",
      "46                                CMA3856_min       1\n",
      "45                   R6010_OPENTRADECOUNT_min       1\n",
      "44                                    CMA3204       1\n",
      "43              R6040_OPENDEPTTRADECOUNT__2.0       1\n",
      "42                   R6010_OPENTRADECOUNT_max       1\n",
      "41                   R6004_NEWESTTRADEAGE_max       1\n",
      "136       R5007_MO06BANKPROMOTIONINQUIRYCOUNT       1\n"
     ]
    }
   ],
   "source": [
    "wt2 = pd.DataFrame(wt.items(), columns=['Feature', 'Weight'])\n",
    "print_full(wt2.sort_values(['Weight'], ascending=False))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5119, 813)"
      ]
     },
     "execution_count": 131,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dmat.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      SNAPDATE_x DWACCTID_x CUSTOMERNUMBER_x CYCLEDATE_x HADINCREASE_x  \\\n",
      "46631   20140905    6118517       0005348708    20120919             1   \n",
      "46632   20140905    6118517       0005348708    20121019             1   \n",
      "46633   20140905    6118517       0005348708    20121119             1   \n",
      "46634   20140905    6118517       0005348708    20121219             1   \n",
      "46635   20140905    6118517       0005348708    20130119             1   \n",
      "46636   20140905    6118517       0005348708    20130219             1   \n",
      "46637   20140905    6118517       0005348708    20130319             1   \n",
      "46638   20140905    6118517       0005348708    20130419             1   \n",
      "46639   20140905    6118517       0005348708    20130519             1   \n",
      "46640   20140905    6118517       0005348708    20130619             1   \n",
      "46641   20140905    6118517       0005348708    20130719             1   \n",
      "46642   20140905    6118517       0005348708    20130819             1   \n",
      "46643   20140905    6118517       0005348708    20130919             1   \n",
      "46644   20140905    6118517       0005348708    20131019             1   \n",
      "46645   20140905    6118517       0005348708    20131119             1   \n",
      "46646   20140905    6118517       0005348708    20131219             1   \n",
      "46647   20140905    6118517       0005348708    20140119             1   \n",
      "46648   20140905    6118517       0005348708    20140219             1   \n",
      "46649   20140905    6118517       0005348708    20140319             1   \n",
      "46650   20140905    6118517       0005348708    20140419             1   \n",
      "46651   20140905    6118517       0005348708    20140519             1   \n",
      "46652   20140905    6118517       0005348708    20140619             1   \n",
      "46653   20140905    6118517       0005348708    20140719             1   \n",
      "46654   20140905    6118517       0005348708    20140819             1   \n",
      "46655   20140905    6118517       0005348708    20140919             1   \n",
      "46656   20140905    6118517       0005348708    20141019             1   \n",
      "46657   20140905    6118517       0005348708    20141119             1   \n",
      "46658   20140905    6118517       0005348708    20141219             1   \n",
      "46659   20140905    6118517       0005348708    20150119             1   \n",
      "46660   20140905    6118517       0005348708    20150219             1   \n",
      "46661   20140905    6118517       0005348708    20150319             1   \n",
      "46662   20140905    6118517       0005348708    20150419             1   \n",
      "46663   20140905    6118517       0005348708    20150519             1   \n",
      "46664   20140905    6118517       0005348708    20150619             1   \n",
      "46665   20140905    6118517       0005348708    20150719             1   \n",
      "46666   20140905    6118517       0005348708    20150819             1   \n",
      "46667   20140905    6118517       0005348708    20150919             1   \n",
      "46668   20140905    6118517       0005348708    20151019             1   \n",
      "46669   20140905    6118517       0005348708    20151119             1   \n",
      "46670   20140905    6118517       0005348708    20151219             1   \n",
      "46671   20140905    6118517       0005348708    20160119             1   \n",
      "46672   20140905    6118517       0005348708    20160219             1   \n",
      "46673   20140905    6118517       0005348708    20160319             1   \n",
      "\n",
      "      FIRSTMEASURABLEDATE_x        MAXREVIEWDATE_x         INCREASEDATE_x  \\\n",
      "46631            2014-09-19  2012-09-13 00:00:00.0  2012-09-06 00:00:00.0   \n",
      "46632            2014-09-19  2012-10-17 00:00:00.0                    NaN   \n",
      "46633            2014-09-19  2012-11-05 00:00:00.0                    NaN   \n",
      "46634            2014-09-19  2012-12-06 00:00:00.0                    NaN   \n",
      "46635            2014-09-19  2013-01-17 00:00:00.0  2013-01-04 00:00:00.0   \n",
      "46636            2014-09-19  2013-02-19 00:00:00.0                    NaN   \n",
      "46637            2014-09-19  2013-02-19 00:00:00.0  2013-03-14 00:00:00.0   \n",
      "46638            2014-09-19  2013-03-26 00:00:00.0                    NaN   \n",
      "46639            2014-09-19  2013-04-24 00:00:00.0                    NaN   \n",
      "46640            2014-09-19  2013-06-06 00:00:00.0  2013-06-07 00:00:00.0   \n",
      "46641            2014-09-19  2013-06-25 00:00:00.0                    NaN   \n",
      "46642            2014-09-19  2013-08-07 00:00:00.0                    NaN   \n",
      "46643            2014-09-19  2013-08-28 00:00:00.0  2013-09-11 00:00:00.0   \n",
      "46644            2014-09-19  2013-09-27 00:00:00.0                    NaN   \n",
      "46645            2014-09-19  2013-10-30 00:00:00.0                    NaN   \n",
      "46646            2014-09-19  2013-10-30 00:00:00.0                    NaN   \n",
      "46647            2014-09-19  2013-12-23 00:00:00.0  2014-01-07 00:00:00.0   \n",
      "46648            2014-09-19  2014-02-04 00:00:00.0                    NaN   \n",
      "46649            2014-09-19  2014-03-05 00:00:00.0  2014-03-05 00:00:00.0   \n",
      "46650            2014-09-19  2014-03-05 00:00:00.0                    NaN   \n",
      "46651            2014-09-19  2014-05-05 00:00:00.0                    NaN   \n",
      "46652            2014-09-19  2014-05-05 00:00:00.0                    NaN   \n",
      "46653            2014-09-19  2014-06-23 00:00:00.0                    NaN   \n",
      "46654            2014-09-19  2014-08-07 00:00:00.0                    NaN   \n",
      "46655            2014-09-19  2014-09-03 00:00:00.0  2014-09-05 16:02:54.0   \n",
      "46656            2014-09-19  2014-09-03 00:00:00.0                    NaN   \n",
      "46657            2014-09-19  2014-11-18 00:00:00.0                    NaN   \n",
      "46658            2014-09-19  2014-12-04 00:00:00.0                    NaN   \n",
      "46659            2014-09-19  2015-01-07 00:00:00.0                    NaN   \n",
      "46660            2014-09-19  2015-02-03 00:00:00.0                    NaN   \n",
      "46661            2014-09-19  2015-03-05 00:00:00.0  2015-03-03 16:03:56.0   \n",
      "46662            2014-09-19  2015-03-27 00:00:00.0                    NaN   \n",
      "46663            2014-09-19  2015-05-15 00:00:00.0                    NaN   \n",
      "46664            2014-09-19  2015-05-15 00:00:00.0                    NaN   \n",
      "46665            2014-09-19  2015-06-25 00:00:00.0                    NaN   \n",
      "46666            2014-09-19  2015-07-20 00:00:00.0                    NaN   \n",
      "46667            2014-09-19  2015-08-26 00:00:00.0  2015-09-02 16:06:23.0   \n",
      "46668            2014-09-19  2015-09-22 00:00:00.0                    NaN   \n",
      "46669            2014-09-19  2015-11-19 00:00:00.0                    NaN   \n",
      "46670            2014-09-19  2015-12-18 00:00:00.0                    NaN   \n",
      "46671            2014-09-19  2015-12-18 00:00:00.0                    NaN   \n",
      "46672            2014-09-19  2016-02-16 00:00:00.0                    NaN   \n",
      "46673            2014-09-19  2016-02-16 00:00:00.0  2016-03-04 16:09:42.0   \n",
      "\n",
      "      INCRTYPE_x           RANDOMNUM_x   ...   CMA3986 CMA3987 CMA3151  \\\n",
      "46631  Temporary  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46632        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46633        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46634        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46635  Permanent  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46636        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46637  Temporary  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46638        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46639        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46640  Permanent  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46641        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46642        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46643  Temporary  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46644        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46645        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46646        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46647  Permanent  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46648        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46649  Temporary  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46650        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46651        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46652        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46653        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46654        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46655  Temporary  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46656        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46657        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46658        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46659        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46660        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46661  Temporary  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46662        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46663        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46664        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46665        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46666        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46667  Temporary  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46668        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46669        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46670        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46671        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46672        NaN  0.000990143511905402   ...       NaN     NaN      01   \n",
      "46673  Temporary  0.000990143511905402   ...       NaN     NaN      01   \n",
      "\n",
      "      CMA3635  CMA3170  CMA3209 CMA3660 CMA3652 CMA3662 CMA3682  \n",
      "46631      01  0039701  0042500      00      98      00      98  \n",
      "46632      01  0039701  0042500      00      98      00      98  \n",
      "46633      01  0039617  0042500      00      98      00      98  \n",
      "46634      01  0039617  0042500      00      98      00      98  \n",
      "46635      01  0039488  0042500      00      98      00      98  \n",
      "46636      01  0039444  0042500      00      98      00      98  \n",
      "46637      01  0039444  0042500      00      98      00      98  \n",
      "46638      01  0039400  0042500      00      98      00      98  \n",
      "46639      01  0039356  0042500      00      98      00      98  \n",
      "46640      01  0039311  0042500      00      98      00      98  \n",
      "46641      01  0039311  0042500      00      98      00      98  \n",
      "46642      01  0039174  0042500      00      98      00      98  \n",
      "46643      01  0039174  0042500      00      98      00      98  \n",
      "46644      01  0039128  0042500      00      98      00      98  \n",
      "46645      01  0039128  0042500      00      98      00      98  \n",
      "46646      01  0039128  0042500      00      98      00      98  \n",
      "46647      01  0038987  0042500      00      98      00      98  \n",
      "46648      01  0038890  0042500      00      98      00      98  \n",
      "46649      01  0038842  0042500      00      98      00      98  \n",
      "46650      01  0038842  0042500      00      98      00      98  \n",
      "46651      01  0038683  0042500      00      98      00      98  \n",
      "46652      01  0038683  0042500      00      98      00      98  \n",
      "46653      01  0038511  0042500      00      98      00      98  \n",
      "46654      01  0038511  0042500      00      98      00      98  \n",
      "46655      01  0038460  0042500      00      98      00      98  \n",
      "46656      01  0038460  0042500      00      98      00      98  \n",
      "46657      01  0038301  0042500      00      98      00      98  \n",
      "46658      01  0038247  0042500      00      98      00      98  \n",
      "46659      01  0038193  0042500      00      98      00      98  \n",
      "46660      01  0038138  0042500      00      98      00      98  \n",
      "46661      01  0038138  0042500      00      98      00      98  \n",
      "46662      01  0038083  0042500      00      98      00      98  \n",
      "46663      01  0037972  0042500      00      98      00      98  \n",
      "46664      01  0037972  0042500      00      98      00      98  \n",
      "46665      01  0037915  0042500      00      98      00      98  \n",
      "46666      01  0037858  0042500      00      98      00      98  \n",
      "46667      01  0037743  0042500      00      98      00      98  \n",
      "46668      01  0037743  0042500      00      98      00      98  \n",
      "46669      01  0037743  0042500      00      98      00      98  \n",
      "46670      01  0037566  0042500      00      98      00      98  \n",
      "46671      01  0037566  0042500      00      98      00      98  \n",
      "46672      01  0037385  0042500      00      98      00      98  \n",
      "46673      01  0037385  0042500      00      98      00      98  \n",
      "\n",
      "[43 rows x 612 columns]\n"
     ]
    }
   ],
   "source": [
    "one_cust_id = sam_all['DWACCTID_x'].sample(1)\n",
    "one_cust = sam_all.ix[sam_all['DWACCTID_x'].isin(one_cust_id),:]\n",
    "print_full(one_cust)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
